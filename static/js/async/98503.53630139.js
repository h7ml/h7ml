/*! For license information please see 98503.53630139.js.LICENSE.txt */
(self.webpackChunkh7ml=self.webpackChunkh7ml||[]).push([["98503"],{65133:function(e,n,t){"use strict";t.r(n);var r=t("52676"),a=t("40453");function o(e){let n=Object.assign({h1:"h1",a:"a",pre:"pre",code:"code"},(0,a.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.h1,{id:"objectdefineproperty-\u6838\u5FC3\u4EE3\u7801-\u81EA\u5B9A\u4E49\u5B9E\u73B0",children:["Object.defineproperty \u6838\u5FC3\u4EE3\u7801 \u81EA\u5B9A\u4E49\u5B9E\u73B0",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#objectdefineproperty-\u6838\u5FC3\u4EE3\u7801-\u81EA\u5B9A\u4E49\u5B9E\u73B0",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u89E6\u53D1\u66F4\u65B0\u89C6\u56FE\nfunction updateView() {\n  console.log('\u89C6\u56FE\u66F4\u65B0');\n}\n\n// \u91CD\u65B0\u5B9A\u4E49\u6570\u7EC4\u539F\u578B\nconst oldArrayProperty = Array.prototype;\n// \u521B\u5EFA\u65B0\u5BF9\u8C61\uFF0C\u539F\u578B\u6307\u5411 oldArrayProperty \uFF0C\u518D\u6269\u5C55\u65B0\u7684\u65B9\u6CD5\u4E0D\u4F1A\u5F71\u54CD\u539F\u578B\nconst arrProto = Object.create(oldArrayProperty);\n['push', 'pop', 'shift', 'unshift', 'splice'].forEach((methodName) => {\n  arrProto[methodName] = function () {\n    updateView(); // \u89E6\u53D1\u89C6\u56FE\u66F4\u65B0\n    oldArrayProperty[methodName].call(this, ...arguments);\n    // Array.prototype.push.call(this, ...arguments)\n  };\n});\n\n// \u91CD\u65B0\u5B9A\u4E49\u5C5E\u6027\uFF0C\u76D1\u542C\u8D77\u6765\nfunction defineReactive(target, key, value) {\n  // \u6DF1\u5EA6\u76D1\u542C\n  observer(value);\n\n  // \u6838\u5FC3 API\n  Object.defineProperty(target, key, {\n    get() {\n      return value;\n    },\n    set(newValue) {\n      if (newValue !== value) {\n        // \u6DF1\u5EA6\u76D1\u542C\n        observer(newValue);\n\n        // \u8BBE\u7F6E\u65B0\u503C\n        // \u6CE8\u610F\uFF0Cvalue \u4E00\u76F4\u5728\u95ED\u5305\u4E2D\uFF0C\u6B64\u5904\u8BBE\u7F6E\u5B8C\u4E4B\u540E\uFF0C\u518D get \u65F6\u4E5F\u662F\u4F1A\u83B7\u53D6\u6700\u65B0\u7684\u503C\n        value = newValue;\n\n        // \u89E6\u53D1\u66F4\u65B0\u89C6\u56FE\n        updateView();\n      }\n    },\n  });\n}\n\n// \u76D1\u542C\u5BF9\u8C61\u5C5E\u6027\nfunction observer(target) {\n  if (typeof target !== 'object' || target === null) {\n    // \u4E0D\u662F\u5BF9\u8C61\u6216\u6570\u7EC4\n    return target;\n  }\n\n  // \u6C61\u67D3\u5168\u5C40\u7684 Array \u539F\u578B\n  // Array.prototype.push = function () {\n  //     updateView()\n  //     ...\n  // }\n\n  if (Array.isArray(target)) {\n    target.__proto__ = arrProto;\n  }\n\n  // \u91CD\u65B0\u5B9A\u4E49\u5404\u4E2A\u5C5E\u6027\uFF08for in \u4E5F\u53EF\u4EE5\u904D\u5386\u6570\u7EC4\uFF09\n  for (let key in target) {\n    defineReactive(target, key, target[key]);\n  }\n}\n\n// \u51C6\u5907\u6570\u636E\nconst data = {\n  name: 'zhangsan',\n  age: 20,\n  info: {\n    address: '\u5317\u4EAC', // \u9700\u8981\u6DF1\u5EA6\u76D1\u542C\n  },\n  nums: [10, 20, 30],\n};\n\n// \u76D1\u542C\u6570\u636E\nobserver(data);\n\n// \u6D4B\u8BD5\n// data.name = 'lisi'\n// data.age = 21\n// // console.log('age', data.age)\n// data.x = '100' // \u65B0\u589E\u5C5E\u6027\uFF0C\u76D1\u542C\u4E0D\u5230 \u2014\u2014 \u6240\u4EE5\u6709 Vue.set\n// delete data.name // \u5220\u9664\u5C5E\u6027\uFF0C\u76D1\u542C\u4E0D\u5230 \u2014\u2014 \u6240\u6709\u5DF2 Vue.delete\n// data.info.address = '\u4E0A\u6D77' // \u6DF1\u5EA6\u76D1\u542C\ndata.nums.push(4); // \u76D1\u542C\u6570\u7EC4\n"})})]})}function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,a.ah)(),e.components);return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}n.default=s,s.__RSPRESS_PAGE_META={},s.__RSPRESS_PAGE_META["posts%2Fvue%2FObject-defineproperty.md"]={toc:[],title:"Object.defineproperty \u6838\u5FC3\u4EE3\u7801 \u81EA\u5B9A\u4E49\u5B9E\u73B0",frontmatter:{icon:"vue",order:1,date:"2021-06-27T00:00:00.000Z",author:"h7ml",category:"vue",tag:"vue",star:!0}}}}]);