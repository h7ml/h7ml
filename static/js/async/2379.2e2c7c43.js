/*! For license information please see 2379.2e2c7c43.js.LICENSE.txt */
(self.webpackChunkh7ml=self.webpackChunkh7ml||[]).push([["2379"],{28827:function(e,n,r){"use strict";r.r(n);var i=r("52676"),s=r("40453");function a(e){let n=Object.assign({h2:"h2",a:"a",p:"p",h3:"h3",blockquote:"blockquote",pre:"pre",code:"code",ul:"ul",li:"li",ol:"ol",img:"img",h4:"h4"},(0,s.ah)(),e.components);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.h2,{id:"\u4E0D\u53EF\u91CD\u5165\u9501",children:["\u4E0D\u53EF\u91CD\u5165\u9501",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u4E0D\u53EF\u91CD\u5165\u9501",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:"\u5373\u82E5\u5F53\u524D\u7EBF\u7A0B\u6267\u884C\u67D0\u4E2A\u65B9\u6CD5\u5DF2\u7ECF\u83B7\u53D6\u4E86\u8BE5\u9501\uFF0C\u90A3\u4E48\u5728\u65B9\u6CD5\u4E2D\u5C1D\u8BD5\u518D\u6B21\u83B7\u53D6\u9501\u65F6\uFF0C\u5C31\u4F1A\u83B7\u53D6\u4E0D\u5230\u800C\u963B\u585E\uFF0C\u76F4\u5230\u5F53\u524D\u7EBF\u7A0B\u91CA\u653E\u9501\u540E\u624D\u80FD\u83B7\u53D6\u3002"}),"\n",(0,i.jsxs)(n.h2,{id:"\u53EF\u91CD\u5165\u9501",children:["\u53EF\u91CD\u5165\u9501",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u53EF\u91CD\u5165\u9501",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:"\u53EF\u91CD\u5165\u9501\uFF0C\u4E5F\u53EB\u505A\u9012\u5F52\u9501\uFF0C\u6307\u7684\u662F\u5728\u540C\u4E00\u7EBF\u7A0B\u5185\uFF0C\u5916\u5C42\u51FD\u6570\u83B7\u5F97\u9501\u4E4B\u540E\uFF0C\u5185\u5C42\u9012\u5F52\u51FD\u6570\u4ECD\u7136\u53EF\u4EE5\u83B7\u53D6\u5230\u8BE5\u9501\u3002 \u5C31\u662F\u540C\u4E00\u4E2A\u7EBF\u7A0B\u518D\u6B21\u8FDB\u5165\u540C\u6837\u4EE3\u7801\u65F6\uFF0C\u53EF\u4EE5\u518D\u6B21\u62FF\u5230\u8BE5\u9501\u3002"}),"\n",(0,i.jsxs)(n.h3,{id:"\u53EF\u91CD\u5165\u9501\u4F5C\u7528",children:["\u53EF\u91CD\u5165\u9501\u4F5C\u7528",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u53EF\u91CD\u5165\u9501\u4F5C\u7528",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:"\u9632\u6B62\u5728\u540C\u4E00\u7EBF\u7A0B\u4E2D\u591A\u6B21\u83B7\u53D6\u9501\u800C\u5BFC\u81F4\u6B7B\u9501\u53D1\u751F"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u5728 java \u7684\u7F16\u7A0B\u4E2D synchronized \u548C ReentrantLock \u90FD\u662F\u53EF\u91CD\u5165\u9501"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u7528\u4E00\u6BB5 Java \u4EE3\u7801\u89E3\u91CA\u53EF\u91CD\u5165\uFF1A"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"public synchronized void lockA() {\n    lockB();\n}\npublic synchronized void lockB() {\n    // pass\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u5047\u8BBE X \u7EBF\u7A0B\u5728 lockA \u65B9\u6CD5\u83B7\u53D6\u9501\u4E4B\u540E\uFF0C\u7EE7\u7EED\u6267\u884C lockB \u65B9\u6CD5\uFF0C\u5982\u679C\u6B64\u65F6\u4E0D\u53EF\u91CD\u5165\uFF0C\u7EBF\u7A0B\u5C31\u5FC5\u987B\u7B49\u5F85\u9501\u91CA\u653E\uFF0C\u518D\u6B21\u4E89\u62A2\u9501\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u9501\u660E\u660E\u662F\u88AB X \u7EBF\u7A0B\u62E5\u6709\uFF0C\u5374\u8FD8\u9700\u8981\u7B49\u5F85\u81EA\u5DF1\u91CA\u653E\u9501\uFF0C\u7136\u540E\u518D\u53BB\u62A2\u9501\uFF0C\u8FD9\u770B\u8D77\u6765\u5C31\u5F88\u5947\u602A\uFF0C\u6211\u91CA\u653E\u6211\u81EA\u5DF1~"}),"\n",(0,i.jsxs)(n.h2,{id:"reentrantlock-\u53EF\u91CD\u5165\u9501\u6E90\u7801\u601D\u8DEF",children:["ReentrantLock \u53EF\u91CD\u5165\u9501\u6E90\u7801\u601D\u8DEF",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#reentrantlock-\u53EF\u91CD\u5165\u9501\u6E90\u7801\u601D\u8DEF",children:"#"})]}),"\n",(0,i.jsxs)(n.h3,{id:"\u52A0\u9501",children:["\u52A0\u9501",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u52A0\u9501",children:"#"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'/**\n * ReentrantLock\u7684\u52A0\u9501\u6D41\u7A0B\u662F\uFF1A\n * 1\uFF0C\u5148\u5224\u65AD\u662F\u5426\u6709\u7EBF\u7A0B\u6301\u6709\u9501\uFF0C\u6CA1\u6709\u52A0\u9501\u8FDB\u884C\u52A0\u9501\n * 2\u3001\u5982\u679C\u52A0\u9501\u6210\u529F\uFF0C\u5219\u8BBE\u7F6E\u6301\u6709\u9501\u7684\u7EBF\u7A0B\u662F\u5F53\u524D\u7EBF\u7A0B\n * 3\u3001\u5982\u679C\u6709\u7EBF\u7A0B\u6301\u6709\u4E86\u9501\uFF0C\u5219\u518D\u53BB\u5224\u65AD\uFF0C\u662F\u5426\u662F\u5F53\u524D\u7EBF\u7A0B\u6301\u6709\u4E86\u9501\n * 4\u3001\u5982\u679C\u662F\u5F53\u524D\u7EBF\u7A0B\u6301\u6709\u9501\uFF0C\u5219\u52A0\u9501\u6570\u91CF\uFF08state\uFF09+1\n */\nfinal boolean nonfairTryAcquire(int acquires) {\n    final Thread current = Thread.currentThread();\n    int c = getState();\n    //\u5148\u5224\u65AD\uFF0Cc\uFF08state\uFF09\u662F\u5426\u7B49\u4E8E0\uFF0C\u5982\u679C\u7B49\u4E8E0\uFF0C\u8BF4\u660E\u6CA1\u6709\u7EBF\u7A0B\u6301\u6709\u9501\n    if (c == 0) {\n        //\u901A\u8FC7cas\u65B9\u6CD5\u628Astate\u7684\u503C0\u66FF\u6362\u62101\uFF0C\u66FF\u6362\u6210\u529F\u8BF4\u660E\u52A0\u9501\u6210\u529F\n        if (compareAndSetState(0, acquires)) {\n            //\u5982\u679C\u52A0\u9501\u6210\u529F\uFF0C\u8BBE\u7F6E\u6301\u6709\u9501\u7684\u7EBF\u7A0B\u662F\u5F53\u524D\u7EBF\u7A0B\n            setExclusiveOwnerThread(current);\n            return true;\n        }\n    } else if (current == getExclusiveOwnerThread()) {//\u5224\u65AD\u5F53\u524D\u6301\u6709\u9501\u7684\u7EBF\u7A0B\u662F\u5426\u662F\u5F53\u524D\u7EBF\u7A0B\n        //\u5982\u679C\u662F\u5F53\u524D\u7EBF\u7A0B\uFF0C\u5219state\u503C\u52A0acquires\uFF0C\u4EE3\u8868\u4E86\u5F53\u524D\u7EBF\u7A0B\u52A0\u9501\u4E86\u591A\u5C11\u6B21\n        int nextc = c + acquires;\n        if (nextc < 0) // overflow\n            throw new Error("Maximum lock count exceeded");\n        setState(nextc);\n        return true;\n    }\n    return false;\n}\n'})}),"\n",(0,i.jsxs)(n.h3,{id:"\u89E3\u9501",children:["\u89E3\u9501",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u89E3\u9501",children:"#"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"/**\n * \u770BReentrantLock\u7684\u89E3\u9501\u4EE3\u7801\u6211\u4EEC\u77E5\u9053\uFF0C\u6BCF\u6B21\u91CA\u653E\u9501\u7684\u65F6\u5019\u90FD\u5BF9state\u51CF1\uFF0C\n * \u5F53c\u503C\u7B49\u4E8E0\u7684\u65F6\u5019\uFF0C\u8BF4\u660E\u9501\u91CD\u5165\u6B21\u6570\u4E5F\u4E3A0\u4E86\uFF0C\n * \u6700\u7EC8\u8BBE\u7F6E\u5F53\u524D\u6301\u6709\u9501\u7684\u7EBF\u7A0B\u4E3Anull,state\u4E5F\u8BBE\u7F6E\u4E3A0\uFF0C\u9501\u5C31\u91CA\u653E\u4E86\u3002\n */\nprotected final boolean tryRelease(int releases) {\n    int c = getState() - releases;//state-1 \u51CF\u52A0\u9501\u6B21\u6570\n    //\u5982\u679C\u6301\u6709\u9501\u7684\u7EBF\u7A0B\uFF0C\u4E0D\u662F\u5F53\u524D\u7EBF\u7A0B\uFF0C\u629B\u51FA\u5F02\u5E38\n    if (Thread.currentThread() != getExclusiveOwnerThread())\n        throw new IllegalMonitorStateException();\n    boolean free = false;\n    if (c == 0) {//\u5982\u679Cc==0\u4E86\u8BF4\u660E\u5F53\u524D\u7EBF\u7A0B\uFF0C\u5DF2\u7ECF\u8981\u91CA\u653E\u9501\u4E86\n        free = true;\n        setExclusiveOwnerThread(null);//\u8BBE\u7F6E\u5F53\u524D\u6301\u6709\u9501\u7684\u7EBF\u7A0B\u4E3Anull\n    }\n    setState(c);//\u8BBE\u7F6Ec\u7684\u503C\n    return free;\n}\n"})}),"\n",(0,i.jsxs)(n.h2,{id:"\u5206\u5E03\u5F0F\u91CD\u5165\u9501redisson-\u4F9D\u7136\u5B9E\u73B0\u4F46\u6B64\u5904\u6CE8\u91CD\u539F\u7406\u5B9E\u73B0",children:["\u5206\u5E03\u5F0F\u91CD\u5165\u9501\uFF08redisson \u4F9D\u7136\u5B9E\u73B0\uFF0C\u4F46\u6B64\u5904\u6CE8\u91CD\u539F\u7406\u5B9E\u73B0\uFF09",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u5206\u5E03\u5F0F\u91CD\u5165\u9501redisson-\u4F9D\u7136\u5B9E\u73B0\u4F46\u6B64\u5904\u6CE8\u91CD\u539F\u7406\u5B9E\u73B0",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:"\u57FA\u4E8E ReentrantLock \u7684\u6E90\u7801\u6211\u4EEC\u77E5\u9053\uFF0C\u5B83\u662F\u52A0\u9501\u6210\u529F\u4E86\uFF0C\u8BB0\u5F55\u4E86\u5F53\u524D\u6301\u6709\u9501\u7684\u7EBF\u7A0B\uFF0C\u5E76\u901A\u8FC7\u4E00\u4E2A int \u7C7B\u578B\u7684\u6570\u5B57\uFF0C\u6765\u8BB0\u5F55\u4E86\u52A0\u9501\u6B21\u6570\u3002\u6211\u4EEC\u77E5\u9053 ReentrantLock \u7684\u5B9E\u73B0\u539F\u7406\u4E86\uFF0C\u90A3\u4E48 redis \u53EA\u8981\u4E0B\u9762\u4E24\u4E2A\u95EE\u9898\u89E3\u51B3\uFF0C\u5C31\u80FD\u5B9E\u73B0\u91CD\u5165\u9501\u4E86\uFF1A"}),"\n",(0,i.jsxs)(n.h3,{id:"1\u5982\u4F55\u4FDD\u5B58\u73B0\u6709\u7684\u7EBF\u7A0B",children:["1.\u5982\u4F55\u4FDD\u5B58\u73B0\u6709\u7684\u7EBF\u7A0B",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#1\u5982\u4F55\u4FDD\u5B58\u73B0\u6709\u7684\u7EBF\u7A0B",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:"ReentrantLock \u4F7F\u7528\u7684\u662F\u5F53\u524D\u7EBF\u7A0B\u5185\u5B58\u5730\u5740\u8FDB\u884C\u5BF9\u6BD4\uFF0C\u90A3\u4E48\u6211\u4EEC\u5C31\u53EF\u4EE5\u4F7F\u7528\u7EBF\u7A0B\u7684 ID \u8FDB\u884C\u6BD4\u8F83\u4E00\u6837\u53EF\u4EE5\u7684\u3002\u4F46\u662F\u5728\u5206\u5E03\u5F0F\u73AF\u5883\u4E0B\uFF0C\u8FD9\u4E2A ID \u5C31\u53EF\u80FD\u4F1A\u5B58\u5728\u91CD\u590D\uFF0C\u6B64\u65F6\uFF0C\u6211\u4EEC\u9700\u8981\u589E\u52A0\u4E00\u4E2A\u5168\u5C40\u7684\u552F\u4E00 ID + \u7EBF\u7A0B ID \u6765\u505A\u4E00\u4E2A\u5206\u5E03\u5F0F\u7EBF\u7A0B\u6BD4\u8F83\u3002"}),"\n",(0,i.jsxs)(n.h3,{id:"2\u52A0\u9501\u6B21\u6570\u91CD\u5165\u4E86\u591A\u5C11\u6B21\u600E\u4E48\u8BB0\u5F55\u7EF4\u62A4",children:["2.\u52A0\u9501\u6B21\u6570\uFF08\u91CD\u5165\u4E86\u591A\u5C11\u6B21\uFF09\uFF0C\u600E\u4E48\u8BB0\u5F55\u7EF4\u62A4",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#2\u52A0\u9501\u6B21\u6570\u91CD\u5165\u4E86\u591A\u5C11\u6B21\u600E\u4E48\u8BB0\u5F55\u7EF4\u62A4",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:"\u4ED6\u80FD\u8BB0\u5F55\u4E0B\u6765\u52A0\u9501\u6B21\u6570\u5417\uFF1F\u5982\u679C valus \u503C\u5B58\u7684\u683C\u5F0F\u662F\uFF1A\u7CFB\u8FDB\u7A0B id+\u7EBF\u7A0B id+\u52A0\u9501\u6B21\u6570\uFF0C\u90A3\u53EF\u4EE5\u5B9E\u73B0\u5B58\u6CA1\u95EE\u9898\u4E86\uFF0C\u4F46\u662F\u91CD\u5165\u6B21\u6570\u8981\u600E\u4E48\u7EF4\u62A4\u4E86\uFF0C \u5B83\u80AF\u5B9A\u8981\u4FDD\u8BC1\u539F\u5B50\u6027\u7684\uFF0C\u80FD\u89E3\u51B3\u5417\uFF1F\u597D\u50CF\u7528 java \u4EE3\u7801\u6216\u8005 lua \u811A\u672C\u90FD\u6CA1\u6CD5\u89E3\u51B3\uFF0C\u56E0\u4E3A\u90FD\u662F\u5B9E\u73B0\u90FD\u9700\u8981\u4E24\u6B65\u6765\u7EF4\u62A4\u8FD9\u4E2A\u91CD\u5165\u6B21\u6570\u7684"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u7B2C\u4E00\u6B65\uFF1A\u5148\u83B7\u53D6\u5230 valus \u503C\uFF0C\u628A\u53D6\u5230\u52A0\u9501\u6B21\u6570+1"}),"\n",(0,i.jsx)(n.li,{children:"\u7B2C\u4E8C\u6B65\uFF1A\u628A\u65B0\u7684\u503C\u518D\u8BBE\u7F6E\u8FDB\u53BB\u5728\u6267\u884C\u7B2C\u4E8C\u6B65\u64CD\u4F5C\u4E4B\u524D\uFF0C\u5982\u679C\u8FD9\u4E2A key \u5931\u6548\u4E86\uFF08\u8BBE\u7F6E\u6301\u6709\u9501\u8D85\u65F6\u4E86\uFF09\uFF0C\u5982\u679C\u8FD8\u80FD\u518D\u8BBE\u7F6E\u8FDB\u53BB\uFF0C\u5C31\u4F1A\u6709\u5E76\u53D1\u95EE\u9898\u4E86"}),"\n"]}),"\n",(0,i.jsxs)(n.h2,{id:"redisson-\u662F\u5982\u4F55\u5B9E\u73B0\u7684",children:["Redisson \u662F\u5982\u4F55\u5B9E\u73B0\u7684",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#redisson-\u662F\u5982\u4F55\u5B9E\u73B0\u7684",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:"\u6211\u4EEC\u8DDF\u4E00\u4E0B lock.lock()\u7684\u4EE3\u7801\uFF0C\u53D1\u73B0\u5B83\u6700\u7EC8\u8C03\u7528\u7684\u662F org.redisson.RedissonLock#tryLockInnerAsync \u7684\u65B9\u6CD5,\u5177\u4F53\u5982\u4E0B\uFF1A"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'<T> RFuture<T> tryLockInnerAsync(long waitTime, long leaseTime, TimeUnit unit, long threadId, RedisStrictCommand<T> command) {\n    return evalWriteAsync(getRawName(), LongCodec.INSTANCE, command,\n            "if (redis.call(\'exists\', KEYS[1]) == 0) then " +\n                    "redis.call(\'hincrby\', KEYS[1], ARGV[2], 1); " +\n                    "redis.call(\'pexpire\', KEYS[1], ARGV[1]); " +\n                    "return nil; " +\n                    "end; " +\n                    "if (redis.call(\'hexists\', KEYS[1], ARGV[2]) == 1) then " +\n                    "redis.call(\'hincrby\', KEYS[1], ARGV[2], 1); " +\n                    "redis.call(\'pexpire\', KEYS[1], ARGV[1]); " +\n                    "return nil; " +\n                    "end; " +\n                    "return redis.call(\'pttl\', KEYS[1]);",\n            Collections.singletonList(getRawName()), unit.toMillis(leaseTime), getLockName(threadId));\n}\n'})}),"\n",(0,i.jsxs)(n.h3,{id:"\u5206\u6790\u4E00\u4E0B-redis-\u547D\u4EE4",children:["\u5206\u6790\u4E00\u4E0B redis \u547D\u4EE4",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u5206\u6790\u4E00\u4E0B-redis-\u547D\u4EE4",children:"#"})]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"exists \u67E5\u8BE2\u4E00\u4E2A key \u662F\u5426\u5B58\u5728"}),"\n",(0,i.jsx)(n.li,{children:"hincrby \uFF1A\u5C06 hash \u4E2D\u6307\u5B9A\u57DF\u7684\u503C\u589E\u52A0\u7ED9\u5B9A\u7684\u6570\u5B57"}),"\n",(0,i.jsx)(n.li,{children:"pexpire\uFF1A\u8BBE\u7F6E key \u7684\u6709\u6548\u65F6\u95F4\u4EE5\u6BEB\u79D2\u4E3A\u5355\u4F4D"}),"\n",(0,i.jsx)(n.li,{children:"hexists\uFF1A\u5224\u65AD field \u662F\u5426\u5B58\u5728\u4E8E hash \u4E2D"}),"\n",(0,i.jsx)(n.li,{children:"pttl\uFF1A\u83B7\u53D6 key \u7684\u6709\u6548\u6BEB\u79D2\u6570"}),"\n",(0,i.jsx)(n.li,{children:"KEYS[1] = key \u7684\u503C"}),"\n",(0,i.jsx)(n.li,{children:"ARGV[1]) = \u6301\u6709\u9501\u7684\u65F6\u95F4"}),"\n",(0,i.jsx)(n.li,{children:"ARGV[2] = getLockName(threadId) \u4E0B\u9762 id \u5C31\u7B97\u7CFB\u7EDF\u5728\u542F\u52A8\u7684\u65F6\u5019\u4F1A\u5168\u5C40\u751F\u6210\u7684 uuid \u6765\u4F5C\u4E3A\u5F53\u524D\u8FDB\u7A0B\u7684 id\uFF0C\u52A0\u4E0A\u7EBF\u7A0B id \u5C31\u662F getLockName(threadId)\u4E86\uFF0C\u53EF\u4EE5\u7406\u89E3\u4E3A\uFF1A\u8FDB\u7A0B ID+\u7CFB\u7EDF ID = ARGV[2] \u4E3B\u8981\u4E5F\u662F\u4F7F\u7528\u4E86 lua \u811A\u672C\u6765\u4FDD\u8BC1\u591A\u4E2A\u547D\u4EE4\u6267\u884C\u7684\u539F\u5B50\u6027\uFF0C\u4F7F\u7528\u4E86 hash \u6765\u5B9E\u73B0\u4E86\u5206\u5E03\u5F0F\u9501"}),"\n"]}),"\n",(0,i.jsxs)(n.h3,{id:"lua-\u811A\u672C\u7684\u52A0\u9501\u6D41\u7A0B",children:["lua \u811A\u672C\u7684\u52A0\u9501\u6D41\u7A0B",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#lua-\u811A\u672C\u7684\u52A0\u9501\u6D41\u7A0B",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://nakoruru.h7ml.cn/httpproxy/static.5ibug.net/vitepress/assets/images/redis-lua.png",alt:"redis-lua.png"})}),"\n",(0,i.jsxs)(n.h4,{id:"1\u7B2C\u4E00\u4E2A-if-\u5224\u65AD",children:["1\u3001\u7B2C\u4E00\u4E2A if \u5224\u65AD",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#1\u7B2C\u4E00\u4E2A-if-\u5224\u65AD",children:"#"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"204\u884C\uFF1A\u5B83\u662F\u5148\u5224\u65AD\u4E86\u5F53\u524Dkey\u662F\u5426\u5B58\u5728\uFF0C\u4ECEEXISTS\u547D\u4EE4\u6211\u4EEC\u77E5\u9053\u8FD4\u56DE\u503C\u662F0\u8BF4\u660Ekey\u4E0D\u5B58\u5728\uFF0C\u8BF4\u660E\u6CA1\u6709\u52A0\u9501\n205\u884C\uFF1Ahincrby\u547D\u4EE4\u662F\u5BF9 ARGV[2] = \u8FDB\u7A0BID+\u7CFB\u7EDFID \u8FDB\u884C\u539F\u5B50\u81EA\u589E\u52A01\n206\u884C\uFF1A\u662F\u5BF9\u6574\u4E2Ahash\u8BBE\u7F6E\u8FC7\u671F\u671F\u95F4\n"})}),"\n",(0,i.jsxs)(n.h4,{id:"2\u4E0B\u9762\u6765\u770B\u7B2C\u4E8C\u4E2A-if-\u5224\u65AD",children:["2\u3001\u4E0B\u9762\u6765\u770B\u7B2C\u4E8C\u4E2A if \u5224\u65AD",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#2\u4E0B\u9762\u6765\u770B\u7B2C\u4E8C\u4E2A-if-\u5224\u65AD",children:"#"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"209\u884C\uFF1A\u5224\u65ADfield\u662F\u5426\u5B58\u5728\u4E8Ehash\u4E2D\uFF0C\u5982\u679C\u5B58\u5728\u8FD4\u56DE1\uFF0C\u8FD4\u56DE1\u8BF4\u660E\u662F\u5F53\u524D\u8FDB\u7A0B+\u5F53\u524D\u7EBF\u7A0BID \u4E4B\u524D\u5DF2\u7ECF\u83B7\u5F97\u5230\u9501\u4E86\n210\u884C\uFF1Ahincrby\u547D\u4EE4\u662F\u5BF9 ARGV[2] = \u8FDB\u7A0BID+\u7CFB\u7EDFID \u8FDB\u884C\u539F\u5B50\u81EA\u589E\u52A01\uFF0C\u8BF4\u660E\u91CD\u5165\u6B21\u6570\u52A01\u4E86\n211\u884C\uFF1A\u518D\u5BF9\u6574\u4E2Ahash\u8BBE\u7F6E\u8FC7\u671F\u671F\u95F4\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u6CE8\u610F\uFF1A\u5206\u5E03\u5F0F\u9501\u6709\u8FC7\u671F\u65F6\u95F4\uFF0C\u9ED8\u8BA4-1 \u7684\u65F6\u5019\u662F\u9700\u8981\u81EA\u52A8\u7EED\u671F\u7684\uFF08redisson \u6709\u770B\u95E8\u72D7\u81EA\u52A8\u7EED\u671F\uFF09\uFF0C\u5F53\u670D\u52A1 down \u673A\u540E\u81EA\u7136\u81EA\u52A8\u91CA\u653E\u89E3\u9501\u8FC7\u7A0B\u548C Reentrantlock \u7684\u89E3\u9501\u903B\u8F91\u4E5F\u57FA\u672C\u76F8\u540C\u6CA1\u5565\u597D\u8BF4\u7684\u4E86"})]})}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,s.ah)(),e.components);return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}n.default=d,d.__RSPRESS_PAGE_META={},d.__RSPRESS_PAGE_META["up%2Fredis%2Fredis-lock.md"]={toc:[{text:"\u4E0D\u53EF\u91CD\u5165\u9501",id:"\u4E0D\u53EF\u91CD\u5165\u9501",depth:2},{text:"\u53EF\u91CD\u5165\u9501",id:"\u53EF\u91CD\u5165\u9501",depth:2},{text:"\u53EF\u91CD\u5165\u9501\u4F5C\u7528",id:"\u53EF\u91CD\u5165\u9501\u4F5C\u7528",depth:3},{text:"ReentrantLock \u53EF\u91CD\u5165\u9501\u6E90\u7801\u601D\u8DEF",id:"reentrantlock-\u53EF\u91CD\u5165\u9501\u6E90\u7801\u601D\u8DEF",depth:2},{text:"\u52A0\u9501",id:"\u52A0\u9501",depth:3},{text:"\u89E3\u9501",id:"\u89E3\u9501",depth:3},{text:"\u5206\u5E03\u5F0F\u91CD\u5165\u9501\uFF08redisson \u4F9D\u7136\u5B9E\u73B0\uFF0C\u4F46\u6B64\u5904\u6CE8\u91CD\u539F\u7406\u5B9E\u73B0\uFF09",id:"\u5206\u5E03\u5F0F\u91CD\u5165\u9501redisson-\u4F9D\u7136\u5B9E\u73B0\u4F46\u6B64\u5904\u6CE8\u91CD\u539F\u7406\u5B9E\u73B0",depth:2},{text:"1.\u5982\u4F55\u4FDD\u5B58\u73B0\u6709\u7684\u7EBF\u7A0B",id:"1\u5982\u4F55\u4FDD\u5B58\u73B0\u6709\u7684\u7EBF\u7A0B",depth:3},{text:"2.\u52A0\u9501\u6B21\u6570\uFF08\u91CD\u5165\u4E86\u591A\u5C11\u6B21\uFF09\uFF0C\u600E\u4E48\u8BB0\u5F55\u7EF4\u62A4",id:"2\u52A0\u9501\u6B21\u6570\u91CD\u5165\u4E86\u591A\u5C11\u6B21\u600E\u4E48\u8BB0\u5F55\u7EF4\u62A4",depth:3},{text:"Redisson \u662F\u5982\u4F55\u5B9E\u73B0\u7684",id:"redisson-\u662F\u5982\u4F55\u5B9E\u73B0\u7684",depth:2},{text:"\u5206\u6790\u4E00\u4E0B redis \u547D\u4EE4",id:"\u5206\u6790\u4E00\u4E0B-redis-\u547D\u4EE4",depth:3},{text:"lua \u811A\u672C\u7684\u52A0\u9501\u6D41\u7A0B",id:"lua-\u811A\u672C\u7684\u52A0\u9501\u6D41\u7A0B",depth:3},{text:"1\u3001\u7B2C\u4E00\u4E2A if \u5224\u65AD",id:"1\u7B2C\u4E00\u4E2A-if-\u5224\u65AD",depth:4},{text:"2\u3001\u4E0B\u9762\u6765\u770B\u7B2C\u4E8C\u4E2A if \u5224\u65AD",id:"2\u4E0B\u9762\u6765\u770B\u7B2C\u4E8C\u4E2A-if-\u5224\u65AD",depth:4}],title:"redis\u5B9E\u73B0\u5206\u5E03\u5F0F\u53EF\u91CD\u5165\u9501",frontmatter:{icon:"wrap",order:2,date:"2019-08-05T00:00:00.000Z",author:"h7ml",title:"redis\u5B9E\u73B0\u5206\u5E03\u5F0F\u53EF\u91CD\u5165\u9501",category:"redis",tag:"redis",star:!1}}}}]);