/*! For license information please see 91960.757d11e1.js.LICENSE.txt */
(self.webpackChunkh7ml=self.webpackChunkh7ml||[]).push([["91960"],{2926:function(e,n,r){"use strict";r.r(n);var s=r("52676"),t=r("40453");function c(e){let n=Object.assign({h1:"h1",a:"a",h2:"h2",p:"p",code:"code",pre:"pre",ul:"ul",li:"li"},(0,t.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.h1,{id:"react\u5F00\u53D1\u6280\u5DE7\u603B\u7ED3",children:["React\u5F00\u53D1\u6280\u5DE7\u603B\u7ED3",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#react\u5F00\u53D1\u6280\u5DE7\u603B\u7ED3",children:"#"})]}),"\n",(0,s.jsxs)(n.h2,{id:"1-useimperativehandle-\u66B4\u9732\u90E8\u5206-api",children:["1. useImperativeHandle \u66B4\u9732\u90E8\u5206 API",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#1-useimperativehandle-\u66B4\u9732\u90E8\u5206-api",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"useImperativeHandle"})," \u5141\u8BB8\u6211\u4EEC\u81EA\u5B9A\u4E49\u901A\u8FC7 ref \u66B4\u9732\u7ED9\u7236\u7EC4\u4EF6\u7684\u5B9E\u4F8B\u503C\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"useImperativeHandle(ref, () => ({\n  // \u53EA\u66B4\u9732 focus\uFF0C\u6CA1\u6709\u522B\u7684\n  focus() {\n    realInputRef.current.focus()\n  },\n}))\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"2-flushsync-\u540C\u6B65\u66F4\u65B0dom",children:["2. flushSync \u540C\u6B65\u66F4\u65B0DOM",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#2-flushsync-\u540C\u6B65\u66F4\u65B0dom",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"flushSync"})," \u4E2D\u7684\u4EE3\u7801\u6267\u884C\u540E\uFF0C\u7ACB\u5373\u540C\u6B65\u66F4\u65B0 DOM\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"function handleAdd() {\n  const newTodo = { id: nextId++, text }\n  flushSync(() => {\n    setText('')\n    setTodos([...todos, newTodo])\n  })\n  listRef.current.lastChild.scrollIntoView({\n    behavior: 'smooth',\n    block: 'nearest'\n  })\n}\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"3-usememo-\u7F13\u5B58\u8BA1\u7B97\u7ED3\u679C",children:["3. useMemo \u7F13\u5B58\u8BA1\u7B97\u7ED3\u679C",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#3-usememo-\u7F13\u5B58\u8BA1\u7B97\u7ED3\u679C",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"useMemo"})," Hook \u7C7B\u4F3C\u4E8E Vue \u7684 ",(0,s.jsx)(n.code,{children:"computed"}),"\uFF0C\u7528\u4E8E\u7F13\u5B58\uFF08\u6216\u8005\u8BF4\u8BB0\u5FC6\uFF08",(0,s.jsx)(n.code,{children:"memoize"}),"\uFF09\uFF09\u4E00\u4E2A\u6602\u8D35\u7684\u8BA1\u7B97\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"import { useMemo, useState } from 'react'\n\nfunction TodoList({ todos, filter }) {\n  const [newTodo, setNewTodo] = useState('')\n  const visibleTodos = useMemo(() => {\n    // \u2705 \u9664\u975E todos \u6216 filter \u53D1\u751F\u53D8\u5316\uFF0C\u5426\u5219\u4E0D\u4F1A\u91CD\u65B0\u6267\u884C\n    return getFilteredTodos(todos, filter)\n  }, [todos, filter])\n  // ...\n}\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"4-\u7075\u6D3B\u8FD0\u7528\u7EC4\u4EF6-key",children:["4. \u7075\u6D3B\u8FD0\u7528\u7EC4\u4EF6 key",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#4-\u7075\u6D3B\u8FD0\u7528\u7EC4\u4EF6-key",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"\u901A\u8FC7\u7ED9\u7EC4\u4EF6\u8BBE\u7F6E key\uFF0C\u6211\u4EEC\u53EF\u4EE5\u63A7\u5236\u7EC4\u4EF6\u7684\u91CD\u65B0\u521B\u5EFA\u548C\u72B6\u6001\u91CD\u7F6E\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"<Profile\n  userId={userId}\n  key={userId} // \uD83D\uDC48 \u5F53 userId \u53D8\u5316\u65F6\uFF0CProfile \u7EC4\u4EF6\u5C06\u88AB\u91CD\u65B0\u521B\u5EFA\n/>\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"5-composerefs-\u7EC4\u5408\u591A\u4E2A-ref",children:["5. composeRefs \u7EC4\u5408\u591A\u4E2A ref",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#5-composerefs-\u7EC4\u5408\u591A\u4E2A-ref",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["\u5F53\u9700\u8981\u5C06\u591A\u4E2A ref \u5E94\u7528\u5230\u540C\u4E00\u4E2A\u5143\u7D20\u65F6\uFF0C\u53EF\u4EE5\u4F7F\u7528 ",(0,s.jsx)(n.code,{children:"composeRefs"})," \u51FD\u6570\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"function setRef<T>(ref: PossibleRef<T>, value: T) {\n  if (typeof ref === 'function')\n    ref(value)\n  else if (ref !== null && ref !== undefined)\n    (ref as React.MutableRefObject<T>).current = value\n}\n\nexport function composeRefs<T>(...refs: PossibleRef<T>[]) {\n  return (node: T) => refs.forEach(ref => setRef(ref, node))\n}\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"6-useresizeobserver-\u76D1\u542C\u5143\u7D20\u5927\u5C0F\u53D8\u5316",children:["6. useResizeObserver \u76D1\u542C\u5143\u7D20\u5927\u5C0F\u53D8\u5316",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#6-useresizeobserver-\u76D1\u542C\u5143\u7D20\u5927\u5C0F\u53D8\u5316",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"\u81EA\u5B9A\u4E49 Hook \u6765\u76D1\u542C\u5143\u7D20\u5927\u5C0F\u53D8\u5316\u5E76\u6267\u884C\u56DE\u8C03\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"import { throttle } from 'lodash'\nimport { RefObject, useLayoutEffect, useMemo } from 'react'\n\nexport function useResizeObserver(ref: RefObject<HTMLElement>, callBack: (element: HTMLElement) => void, delay = 50) {\n  const trigger = useMemo(\n    () =>\n      throttle((ele) => {\n        callBack(ele)\n      }, delay),\n    [],\n  )\n\n  useLayoutEffect(() => {\n    if (!ref.current)\n      return\n\n    const observer\n      = 'ResizeObserver' in window\n        ? new ResizeObserver(() => {\n          trigger(ref.current)\n        })\n        : null\n    if (observer)\n      observer.observe(ref.current)\n\n    // initial check\n    trigger(ref.current)\n    return () => {\n      // disconnect\n      if (observer)\n        observer.disconnect()\n    }\n  }, [ref])\n}\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"7-react-\u6DF1\u8272\u6A21\u5F0F\u6697\u9ED1\u6A21\u5F0F",children:["7. React \u6DF1\u8272\u6A21\u5F0F/\u6697\u9ED1\u6A21\u5F0F",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#7-react-\u6DF1\u8272\u6A21\u5F0F\u6697\u9ED1\u6A21\u5F0F",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"\u4F7F\u7528 media \u67E5\u8BE2\u6765\u8BBE\u7F6E\u4E3B\u9898\u8272\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<meta\n  name="theme-color"\n  media="(prefers-color-scheme: light)"\n  content="white" />\n<meta \n  name="theme-color" \n  media="(prefers-color-scheme: dark)" \n  content="black" />\n'})}),"\n",(0,s.jsxs)(n.h2,{id:"8-useeffect-\u4F7F\u7528\u5FC3\u5F97",children:["8. useEffect \u4F7F\u7528\u5FC3\u5F97",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#8-useeffect-\u4F7F\u7528\u5FC3\u5F97",children:"#"})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u7A7A\u4F9D\u8D56\u6570\u7EC4 ",(0,s.jsx)(n.code,{children:"[]"})," \u8868\u793A\u53EA\u5728\u7EC4\u4EF6\u6302\u8F7D\u65F6\u6267\u884C\u4E00\u6B21\u3002"]}),"\n",(0,s.jsx)(n.li,{children:"\u4E0D\u63D0\u4F9B\u4F9D\u8D56\u6570\u7EC4\u4F1A\u5728\u6BCF\u6B21\u6E32\u67D3\u540E\u6267\u884C\u3002"}),"\n",(0,s.jsx)(n.li,{children:"\u5C0F\u5FC3\u4F7F\u7528 DOM refs \u4F5C\u4E3A\u4F9D\u8D56\u3002"}),"\n"]}),"\n",(0,s.jsxs)(n.h2,{id:"9-usereducer-\u7BA1\u7406\u590D\u6742\u72B6\u6001",children:["9. useReducer \u7BA1\u7406\u590D\u6742\u72B6\u6001",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#9-usereducer-\u7BA1\u7406\u590D\u6742\u72B6\u6001",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"\u7528\u4E8E\u7BA1\u7406\u590D\u6742\u7684\u72B6\u6001\u903B\u8F91\uFF0C\u7C7B\u4F3C\u4E8E Redux \u4E2D\u7684 reducer \u6982\u5FF5\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"import React, { useReducer } from 'react';\n\nconst initialState = { count: 0 };\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'increment':\n      return { count: state.count + 1 };\n    case 'decrement':\n      return { count: state.count - 1 };\n    default:\n      throw new Error();\n  }\n}\n\nfunction Counter() {\n  const [state, dispatch] = useReducer(reducer, initialState);\n  return (\n    <>\n      Count: {state.count}\n      <button onClick={() => dispatch({type: 'increment'})}>+</button>\n      <button onClick={() => dispatch({type: 'decrement'})}>-</button>\n    </>\n  );\n}\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"10-\u81EA\u5B9A\u4E49-hook",children:["10. \u81EA\u5B9A\u4E49 Hook",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#10-\u81EA\u5B9A\u4E49-hook",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"\u63D0\u53D6\u53EF\u91CD\u7528\u7684\u7EC4\u4EF6\u903B\u8F91\u5230\u81EA\u5B9A\u4E49 Hook \u4E2D\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:'import { useState, useEffect } from \'react\';\n\nfunction useWindowSize() {\n  const [windowSize, setWindowSize] = useState({\n    width: undefined,\n    height: undefined,\n  });\n\n  useEffect(() => {\n    function handleResize() {\n      setWindowSize({\n        width: window.innerWidth,\n        height: window.innerHeight,\n      });\n    }\n    \n    window.addEventListener("resize", handleResize);\n    handleResize();\n    \n    return () => window.removeEventListener("resize", handleResize);\n  }, []);\n\n  return windowSize;\n}\n'})}),"\n",(0,s.jsxs)(n.h2,{id:"11-reactmemo-\u548C-usecallback",children:["11. React.memo \u548C useCallback",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#11-reactmemo-\u548C-usecallback",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["\u4F7F\u7528 ",(0,s.jsx)(n.code,{children:"React.memo"})," \u548C ",(0,s.jsx)(n.code,{children:"useCallback"})," \u6765\u4F18\u5316\u6027\u80FD\uFF0C\u907F\u514D\u4E0D\u5FC5\u8981\u7684\u91CD\u6E32\u67D3\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"import React, { useCallback, useState } from 'react';\n\nconst MyComponent = React.memo(function MyComponent(props) {\n  /* \u53EA\u6709\u5F53props\u6539\u53D8\u65F6\u624D\u4F1A\u91CD\u65B0\u6E32\u67D3 */\n});\n\nfunction Parent() {\n  const [count, setCount] = useState(0);\n\n  const increment = useCallback(() => {\n    setCount(c => c + 1);\n  }, []);\n\n  return <MyComponent onIncrement={increment} />;\n}\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"12-error-boundaries",children:["12. Error Boundaries",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#12-error-boundaries",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"\u4F7F\u7528\u9519\u8BEF\u8FB9\u754C\u6355\u83B7\u5B50\u7EC4\u4EF6\u6811\u4E2D\u7684 JavaScript \u9519\u8BEF\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"class ErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error) {\n    return { hasError: true };\n  }\n\n  componentDidCatch(error, errorInfo) {\n    logErrorToMyService(error, errorInfo);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return <h1>Something went wrong.</h1>;\n    }\n\n    return this.props.children; \n  }\n}\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"13-portals",children:["13. Portals",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#13-portals",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"\u4F7F\u7528 Portals \u5C06\u5B50\u8282\u70B9\u6E32\u67D3\u5230\u7236\u7EC4\u4EF6 DOM \u6811\u4E4B\u5916\u7684 DOM \u8282\u70B9\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"import ReactDOM from 'react-dom';\n\nfunction Modal({ children }) {\n  return ReactDOM.createPortal(\n    children,\n    document.getElementById('modal-root')\n  );\n}\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"14-uselatestcallback",children:["14. useLatestCallback",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#14-uselatestcallback",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["\u7528\u4E8E\u66FF\u4EE3 ",(0,s.jsx)(n.code,{children:"useCallback"}),"\uFF0C\u89E3\u51B3\u8FD4\u56DE\u51FD\u6570\u5730\u5740\u4E0D\u540C\u7684\u95EE\u9898\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"export function useLatestCallback<F extends (...args: any[]) => any>(fn: F): LatestCallback<F> {\n  const cb = useRef<LatestCallback<F>>()\n  if ('fn' in fn)\n    return fn as any\n\n  if (!cb.current)\n    cb.current = Object.assign<any, any>((...args: any[]) => cb.current!.fn(...args), { fn })\n  else if (cb.current.fn !== fn)\n    cb.current.fn = fn\n\n  return cb.current!\n}\n"})})]})}function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,t.ah)(),e.components);return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}n.default=a,a.__RSPRESS_PAGE_META={},a.__RSPRESS_PAGE_META["posts%2F2024%2Freact-skill.md"]={toc:[{text:"1. useImperativeHandle \u66B4\u9732\u90E8\u5206 API",id:"1-useimperativehandle-\u66B4\u9732\u90E8\u5206-api",depth:2},{text:"2. flushSync \u540C\u6B65\u66F4\u65B0DOM",id:"2-flushsync-\u540C\u6B65\u66F4\u65B0dom",depth:2},{text:"3. useMemo \u7F13\u5B58\u8BA1\u7B97\u7ED3\u679C",id:"3-usememo-\u7F13\u5B58\u8BA1\u7B97\u7ED3\u679C",depth:2},{text:"4. \u7075\u6D3B\u8FD0\u7528\u7EC4\u4EF6 key",id:"4-\u7075\u6D3B\u8FD0\u7528\u7EC4\u4EF6-key",depth:2},{text:"5. composeRefs \u7EC4\u5408\u591A\u4E2A ref",id:"5-composerefs-\u7EC4\u5408\u591A\u4E2A-ref",depth:2},{text:"6. useResizeObserver \u76D1\u542C\u5143\u7D20\u5927\u5C0F\u53D8\u5316",id:"6-useresizeobserver-\u76D1\u542C\u5143\u7D20\u5927\u5C0F\u53D8\u5316",depth:2},{text:"7. React \u6DF1\u8272\u6A21\u5F0F/\u6697\u9ED1\u6A21\u5F0F",id:"7-react-\u6DF1\u8272\u6A21\u5F0F\u6697\u9ED1\u6A21\u5F0F",depth:2},{text:"8. useEffect \u4F7F\u7528\u5FC3\u5F97",id:"8-useeffect-\u4F7F\u7528\u5FC3\u5F97",depth:2},{text:"9. useReducer \u7BA1\u7406\u590D\u6742\u72B6\u6001",id:"9-usereducer-\u7BA1\u7406\u590D\u6742\u72B6\u6001",depth:2},{text:"10. \u81EA\u5B9A\u4E49 Hook",id:"10-\u81EA\u5B9A\u4E49-hook",depth:2},{text:"11. React.memo \u548C useCallback",id:"11-reactmemo-\u548C-usecallback",depth:2},{text:"12. Error Boundaries",id:"12-error-boundaries",depth:2},{text:"13. Portals",id:"13-portals",depth:2},{text:"14. useLatestCallback",id:"14-uselatestcallback",depth:2}],title:"React\u5F00\u53D1\u6280\u5DE7\u603B\u7ED3",frontmatter:{head:[["meta",{name:"og:title",content:"React\u5F00\u53D1\u6280\u5DE7\u603B\u7ED3"}],["meta",{name:"og:url",content:"https://www.h7ml.cn/posts/2024/react-skill"}],["meta",{name:"og:image",content:"https://www.h7ml.cn/logo.png"}]]}}}}]);